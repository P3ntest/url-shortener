<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>P3ntest's Url Shortener</title>
    <script src="https://www.google.com/recaptcha/api.js"></script>
  </head>
  <body>
    <form id="comment_form" action="/url" method="post">
      <input type="text" name="url" placeholder="Original Url" />
      <input type="text" name="short" placeholder="Short" />
      <div class="g-recaptcha" data-sitekey="<%= captcha_key %>"></div>
      <br />
      <input type="submit" name="submit" value="Register" /><br /><br />
    </form>
  </body>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery.form/3.51/jquery.form.min.js"></script>
  <script>
    $(document).ready(function () {
      $("#comment_form").submit(function () {
        $(this).ajaxSubmit({
          error: function (xhr) {
            const error = JSON.parse(xhr.responseText).error;
            const errorCode = JSON.parse(xhr.responseText).error_code; // 1: captcha error 2: url invalid 3: short exists

            // @Jasper hier ist errorCode und error nachricht
            alert(error);
          },
          success: function (response) {
            const short = response.short;
            // @Jasper hier ist dein code wenn es geklappt hat
            alert(short);
          },
        });
        return false;
      });
    });
  </script>
</html>
